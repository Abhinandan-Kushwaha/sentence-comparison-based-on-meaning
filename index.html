<html>
    <head>
        <link rel="stylesheet" href="./styles.css">
        <script type="text/javascript" src="./extract.js"></script>
        <script type="text/javascript" src="./similarity.js"></script>
        <script>

            function fn(){
                document.getElementById('comp').style.display = 'none';
            }

            function e1(){
                let str = extract(document.getElementById('i1').value)
                document.getElementById('t1').innerHTML = str

                document.getElementById("r").innerHTML = ""

                if(str && document.getElementById('t2').innerHTML){
                    // console.log('inside if')
                    document.getElementById('comp').style.display = 'block';
                }
                else{
                    // console.log('inside else')
                    document.getElementById('comp').style.display = 'none';
                }
            }

            function e2(){
                let str = extract(document.getElementById('i2').value)
                document.getElementById('t2').innerHTML = str

                document.getElementById("r").innerHTML = ""

                if(str && document.getElementById('t1').innerHTML){
                    // console.log('inside if')
                    document.getElementById('comp').style.display = 'block';
                }
                else{
                    // console.log('inside else')
                    document.getElementById('comp').style.display = 'none';
                }
            }

            function compare(){
                let s1 = document.getElementById('t1').innerHTML
                let s2 = document.getElementById('t2').innerHTML

                if(s1.length < s2.length){  // Make s1 the bigger string
                    temp = s1
                    s1 = s2
                    s2 = temp
                }

                let w1 = s1.split(' ')
                let w2 = s2.split(' ')

                let l1 = w1.length
                let l2 = w2.length

                let maxL = l1
                let minL = l2

                let word1,word2;
                let maxSim=0,sum=0;

                let similarities = []

                for(let i=0;i<maxL;i++){
                    word1 = w1[i]
                    similarities[i]=[]
                    for(j=0;j<minL;j++){
                        word2 = w2[j]
                        similarities[i][j] = similarity(word1,word2)
                        // console.log(`similarities[${i}][${j}] -> `,similarity(word1,word2))
                    }
                }

                console.log('similarities -> ',similarities)

                for(let i=0;i<maxL;i++){
                    maxSim=0;
                    for(j=0;j<minL;j++){
                        if(similarities[i][j] > maxSim){
                            maxSim = similarities[i][j]
                        }
                    }
                    console.log(`maxValue for ${w1[i]} = `, maxSim)

                    sum += maxSim
                }
                console.log('totalSimilarity -->',sum)
                let avgSimilarity = sum/maxL
                console.log('avgSimilarity -->',avgSimilarity)

                document.getElementById("r").innerHTML = "Similarity  =  " + (avgSimilarity*100) + "%"
            }
        </script>
    </head>

    <body class="bdy" onload="fn()">
        <div class="btncntnr header">
            <h3>This website compares two sentences and displays the percentage of similarity between them</h2>
        </div>
        <div class="container">
            <div class="label">
                Enter Sentence 1
                <textarea class="txtar" id="i1"></textarea>
                <button class="extract" onclick="e1()">Extract Tokens</button>
                <div class="txtout" id="t1"></div>
            </div>
            <div class="label">
                Enter Sentence 2
                <textarea class="txtar" id="i2"></textarea>
                <button class="extract" onclick="e2()">Extract Tokens</button>
                <div class="txtout" id="t2"></div>
            </div>
        </div>
        <div class="btncntnr">
            <button class="btn" id="comp" onclick="compare()">Compare</button>
        </div>
        <div class="btncntnr result" id="r"></div>


        <div style="margin: 10px">
            <h2>How it works</h2>
            <h3>1. Tokenizing and Text pre-processing</h3>
        </div>
        <img src="./sentencePreProcessing.png" class="imageContainer"/>
        <div style="margin-bottom: 10px;">
            <h3>2. Comparing for similarity based on Levenshtein distance</h3>
            <p>
                After preprocessing both the sentences using above approach, compare the 2 output sentences using -
                <a target="_blank" href='https://en.wikipedia.org/wiki/Levenshtein_distance'>Levenshtein distance</a>
            </p>
        </div>
    </body>
</html>